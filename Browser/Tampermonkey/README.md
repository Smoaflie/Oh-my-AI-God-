### 淘宝订单导出工具.js

开始先在chatgpt3.5上尝试生成，一坨，后使用gemini-2.5-pro

*prmopt*:
> (上传"淘宝"-"已购买的宝贝"加载完成后的html源码,可通过右键-查看网页源代码或ctrl+u获得)
>
> ```text
> 帮我基于油猴插件，编写一个快速导出淘宝订单的插件
> 
> 1. 检索页面中所有的订单信息，他们被包裹于：
> 
> <div id="orderColContainer_***************" class="trade-container type-of-row trade-container-orderColContainer">
> 
> 其中*****是一串数字，代表其订单号
> 
> 2. 遍历所有订单中的商品信息
> 
> 3. 在每个订单(（建议在class=shopInfo--bg9ptXDL trade-bought-list-shop-info的左侧添加）)
> 
> 和商品前((itemInfo--cOJabuHA trade-bought-list-order-info左侧)新增一个勾选框，用于选择是否要导出当前订单
> 
> 订单的勾选框会和其下的所有的商品关联（按照我说的三种样式规则，如果此时订单的勾选框为空，单机后会变成勾选，同时勾选旗下所有商品的勾选框）
> 
> (订单前的勾选框有三种状态："空"其中所有商品都不勾选，“方块”勾选了部分商品，“勾”勾选了全部商品）
> 
> 最后导出商品信息时是遍历所有商品自己的勾选框，与订单的勾选框无关！
> 
> 4. 将页面中选中的全部商品，按照以下格式导出为列表：
> 
> [{
> 
> "order_id": #订单号,
> 
> "order_date": #订单日期,
> 
> "item_id": #订单中该商品的序列(从1开始),
> 
> "item_name": #商品名,
> 
> "item_style": #商品类别,
> 
> "item_price": #商品单价(默认使用RMB为单位),
> 
> "item_num": #商品数量,
> 
> "item_original_price": #原价格(部分商品可能因优惠活动存在单价和原价不同，如无则保持和item_price相同)
> 
> "item_image": #商品图片(需要从image--qmstcRYr中style离的url链接处提取，并去除_200x200.jpg类似的格式化部分，保留源图片链接)
> 
> },
> 
> ...
> 
> ]
> 
> 
> 
> 以商品"拨动开关 贴片 7脚两档/8脚三档 MSK-12C02/MSK-02（10只）"为例
> 
> 其导出格式为:
> 
> {
> 
> "order_id": "2995257253550453974",
> 
> "order_date": "2025-10-15",
> 
> "item_id": 1,
> 
> "item_name": "拨动开关 贴片 7脚两档/8脚三档 MSK-12C02/MSK-02（10只）",
> 
> "item_style": "拨动开关/两档7脚 (10只)",
> 
> "item_price": 2.40,
> 
> "item_num": 1,
> 
> "item_original_price": 2.40
> 
> "item_image": "img.alicdn.com/imgextra/i2/2658592015/O1CN01gQqnFZ1QkupAZyrIZ_!!2658592015.jpg"
> 
> }
> 
> 而存在折扣的商品，如"齐心录音笔高清降噪商务培训便携可磁吸声控学生会议专业录音设备"
> 
> 其导出时的部分项目存在区别
> 
> {
> 
> "item_price": 139.00,
> 
> "item_original_price": 159.00
> 
> }
> ```
>
> 尝试后发现生成的脚本会阻碍订单页加载，*我意识到需要延迟加载*，遂命其修改代码：
>
> ```text
> 由于淘宝的订单页面是延迟加载的，当我应用你提供的脚本时，淘宝的订单页面会停止加载。所以我希望该脚本会先在页面上显示一个开启按钮，待订单页面加载完成后由用户手动开启并添加勾选框
> ```
>
> 此时代码无法运行，打开开发者工具，查看控制台内用户脚本的报错，复制给AI让其解决
>
> ```text
> (直接复制错误信息原文，没有其他提示词)
> ```
>
> 此时代码能运行，但无法正常工作，出现例如勾选框未注入成功、已勾选商品无法导出等原因。尝试推到重来，令其整理思路后重新生成代码
>
> ```text
> 从头开始，验证你的脚本是否能正常工作于我提供的示例html代码，对所有商品都不会出现因格式不匹配等原因导致的导出失败
> 
> 将订单的勾选框修改到(订单详情>)的右侧，避免因样式原因被侧边栏覆盖，同时考虑是否要修改网站自带的一些css样式
> ```
>
> 无果，发现错误原因是AI会自动索引一些奇怪的id。比如该是`'div[id^="shopOrderContainer_"]'`它会`'div[id^="orderColContainer_"]'`，即使给出的html文件中甚至无法搜索到`orderColContainer_`
>
> 于是手动修改了事（幸运的是除了索引了奇怪的id号，整个代码逻辑是通的）

*思考*:

没使用cursor是我的错，通用LLM还是不会因为我要求其验证代码，就真的在思维链中模拟运行效果= =

